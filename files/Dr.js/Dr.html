<html>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">

<head>
	<meta charset="UTF-8">
	<meta name="title" content="Welcome to Dr.js!">
	<meta name="keywords" content="Dr.js,Bean,Dr.Eames,thatbean,DrEames,Personal">
	<meta name="description" content="This is a web build by Bean/Dr.Eames">
	
	<meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height, target-densitydpi=device-dpi" />
	
	<title>Welcome to ThatBean.com!</title>
	
    <link href="../../favicon.png" rel="shortcut icon">
	<link href="../../bean_common.css" rel="stylesheet" type="text/css">
	<script src="../../Dr.js"></script>
	<!-- -- >
	<script src="Dr.base_module.js"></script>
	<!-- -->
	<!-- -->
	<script type="text/javascript">
		
		Dr.loadScript('../../Dr.base_module.js', function () {
			var Spec = document.getElementById("Spec");
			var text_list = [
				['devicePixelRatio', window.devicePixelRatio],
				['top.location.href', top.location.href],
				['window.location.href', window.location.href],
				['Dr.Get("Toolbox").getViewportSize()', 'width, height: (' + Dr.Get("Toolbox").getViewportSize().width + ', ' + Dr.Get("Toolbox").getViewportSize().height + ')'],
				['Dr.Get("Toolbox").getPageSize()', 'width, height: (' + Dr.Get("Toolbox").getPageSize().width + ', ' + Dr.Get("Toolbox").getPageSize().height + ')'],
			];
			var result_line = '<table class="align-center font-small">';
			for (var i in text_list) {
				var key = text_list[i][0];
				var value = text_list[i][1];
				var line = '<tr><td><b>' + key + '</b></td><td>' + value + '</td></tr>';
				result_line += line;
			}
			result_line += '</table>';
			//document.write(result_line);
			Spec.innerHTML = result_line;
		});
	
	</script>
	<!-- -->
	<script type="text/javascript">
		var site_url = "thatbean.com";
		
		if(top != window){
			top.location.href = site_url;
		}
		
		window["PATHS_PASSPORT"] = site_url;
	</script>
	
	<script type="text/javascript"> 
		function switch_to_url (target_url) {
			window.location.href = target_url;
		}
		
		function set_body_padding () {
			var page_header = document.getElementById("page-header");
			var padding_header = (page_header ? page_header.offsetHeight : 0) + "px";
			var page_footer = document.getElementById("page-footer");
			var padding_footer = (page_footer ? page_footer.offsetHeight : 0) + "px";
			
			document.body.style.paddingTop = padding_header;
			document.body.style.paddingBottom = padding_footer;
			console.log("set_body_padding", padding_header, padding_footer);
			//add watch
			document.body.onresize = set_body_padding;
		}
		
		function scale_canvas() {
			var canvas = document.getElementById('Dr.Canvas');
			canvas.style.width = Dr.devicePixelRatio * (parseInt(canvas.style.width)) + 'px';
			canvas.style.height = Dr.devicePixelRatio * (parseInt(canvas.style.height)) + 'px';
		}
		
		function set_canvas_script() {
			var canvas = document.getElementById("Dr.Canvas");
			var ctx = canvas.getContext("2d");
			ctx.font = "bold 20px monaco, consolas, monospace";
			ctx.textAlign = "right";
			ctx.textBaseline = "top";
			ctx.fillStyle = "#888";
			ctx.fillText("Test Canvas 640 x 480", 640, 0);
			
			for (var i = 0; i < 10; i++) {
				ctx.font = "bold " + (48 - i * 4).toString() + "px monaco, consolas, monospace";
				ctx.textAlign = "left";
				ctx.textBaseline = "bottom";
				ctx.fillStyle = "#" + (99 - i * 9).toString() + (99 - i * 9).toString() + (99 - i * 9).toString();
				ctx.fillText("Hello Canvas World!", 0, 480 - 48 * i);
			}
			
			var FPS = Dr.Get("FPS")
			var fps = new FPS(function (averageFPS, currentFPS) {
				document.getElementById("FPS").innerHTML = "AvgFPS:" + averageFPS.toFixed(2) + ", CurFPS:" + currentFPS.toFixed(2);
			})
			Dr.UpdateLoop.add(function (delta_time) { 
				fps.FPS(); 
				return true;
			})
			
			var TagLog = Dr.Get("TagLog")
			var tag_log = new TagLog(function (log_text) {
				document.getElementById("Log").innerHTML = log_text;
			})
			Dr.UpdateLoop.add(function (delta_time) { 
				tag_log.Log("update log " + Dr.now()); 
				return true;
			})
			
			Dr.UpdateLoop.start();
		}
		
		window.onload = function () {
			set_body_padding();
			scale_canvas();
			set_canvas_script();
		}
	</script>

	<style>
		#page-header td, #page-footer td { text-align: left; padding: 0.1em; border-left: 1em solid #222; border-right: 1em solid #222; }
		canvas {
			background-color: #aaa;
			margin: 0;
			padding: 0;
			border: solid 4px #999;
			/*width: 100%;
			height: 100%;*/
		}
	</style>
</head>

<body>
	<div id="page-header" class="fix-top">
		<p class="text-center">The test Html of Dr.js</p>
	</div>
	
	<div id="page-footer" class="fix-bottom">
		<table class="align-center">
			<tr>
				<td class="font-small text-center">
					<a href="mailto:Bean@ThatBean.com">Bean@ThatBean.com</a> | 
					<a href="https://github.com/ThatBean">Bean in Git</a> | 
					<a href="http://steamcommunity.com/id/dreames">Dr.Eames in Steam</a> | 
					<a href="http://thatbean.com">thatbean.com</a>
					<br /> 
					&clubs;&infin; Copywrong 2015 by <b class="font-big">Bean/Dr.Eames</b>
				</td>
			</tr>
		</table>
	</div>
	
	<div id="page-content" class="align-center text-center">
		<br />
		
		<canvas id="Dr.Canvas" class="pixelated" width=640 height=480 class="align-center text-center">
			This should be a canvas element. If you're seeing this, consider upgrade your browser
		</canvas>
		
		<p id="FPS">
			FPS here
		</p>
		<p id="Log">
			Log here
		</p>
		
		<div id="Spec">
			Spec here
		</div>
		
		<button onclick="var size = Dr.Get('Toolbox').getViewportSize(); alert('width, height: (' + size.width + ', ' + size.height + ')')">getViewportSize</button>
		<button onclick="var size = Dr.Get('Toolbox').getPageSize(); alert('width, height: (' + size.width + ', ' + size.height + ')')">getPageSize</button>
	</div>
<br />
</body>

</html>
